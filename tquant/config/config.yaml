# 量化交易系统配置文件

# 基础配置
trading:
  # 交易品种
  symbols:
    - "SHFE.cu2401"  # 沪铜2401
    - "DCE.i2403"    # 铁矿石2403
    - "CZCE.MA401"   # 麦子401

  # 交易配置
  account:
    initial_balance: 1000000  # 初始资金 100万
    max_position_ratio: 0.7   # 最大仓位比例

  # 风险控制
  risk:
    max_loss_ratio: 0.02      # 单日最大亏损2%
    stop_loss_ratio: 0.03     # 单笔止损3%
    take_profit_ratio: 0.05   # 单笔止盈5%

# LLM配置
llm:
  # GPT-4o (深度分析)
  gpt4o:
    model: "gpt-4o"
    api_key: "${OPENAI_API_KEY}"
    temperature: 0.7
    max_tokens: 2000
    timeout: 30

  # GPT-4o-mini (快速分析)
  gpt4o_mini:
    model: "gpt-4o-mini"
    api_key: "${OPENAI_API_KEY}"
    temperature: 0.3
    max_tokens: 1000
    timeout: 10

# tqsdk配置
tqsdk:
  auth: "${TQSDK_AUTH}"  # 格式: "username,password"
  backtest: true
  demo: true
  log_level: "INFO"

# 技术指标配置
indicators:
  # 移动平均线
  ma:
    periods: [5, 10, 20, 60]

  # MACD
  macd:
    fast_period: 12
    slow_period: 26
    signal_period: 9

  # RSI
  rsi:
    period: 14
    oversold: 30
    overbought: 70

  # KDJ
  kdj:
    k_period: 9
    d_period: 3
    j_period: 3
    oversold: 20
    overbought: 80

  # 布林带
  bollinger:
    period: 20
    std_dev: 2

  # 威廉指标
  williams_r:
    period: 14
    oversold: -80
    overbought: -20

  # CCI指标
  cci:
    period: 20
    oversold: -100
    overbought: 100

  # DMI指标
  dmi:
    period: 14
    adx_period: 14

  # ATR指标
  atr:
    period: 14

  # 成交量分布
  volume_profile:
    intervals: 10

# 交易信号配置
signals:
  # 信号强度阈值
  thresholds:
    strong_buy: 0.8
    buy: 0.6
    sell: -0.6
    strong_sell: -0.8

  # 信号确认
  confirmation:
    min_indicators_agree: 3  # 至少3个指标同意才确认信号

# 日志配置
logging:
  level: "INFO"
  file: "logs/trading_system.log"
  max_size: "10MB"
  backup_count: 5

# 回测配置
backtest:
  start_date: "2024-01-01"
  end_date: "2024-12-31"
  initial_balance: 1000000
  commission: 0.0003  # 手续费率
  slippage: 0.001      # 滑点
  refresh_interval: 60 # 刷新间隔（秒）
  enable_short: true   # 允许做空

# 工作流配置
workflow:
  # 状态超时时间（秒）
  timeouts:
    analyze_market: 30
    evaluate_signals: 20
    execute_trades: 15
    update_portfolio: 10
    monitor_risk: 5

  # 重试配置
  retry:
    max_attempts: 3
    delay: 1
    backoff_factor: 2

  # 并行处理配置
  parallel:
    max_workers: 5
    batch_size: 10

# 数据源配置
data:
  # tqsdk配置
  tqsdk:
    auth: "${TQSDK_AUTH}"  # 格式: "username,password"
    backtest: true
    demo: true
    log_level: "INFO"
    heartbeat_interval: 30
    reconnect_delay: 10

  # 模拟数据配置（用于测试）
  simulation:
    enable: true
    symbols:
      - "SHFE.cu2401"
      - "DCE.i2403"
      - "CZCE.MA401"
    price_range: 100  # 价格波动范围
    volume_range: [1000, 10000]  # 成交量范围

# 分析引擎配置
analysis:
  # 信号生成配置
  signal_generation:
    min_confidence: 0.5      # 最小置信度
    max_signals_per_symbol: 3  # 每个品种最大信号数
    enable_diversification: true  # 启用分散化

  # 技术分析配置
  technical_analysis:
    use_weighted_average: true   # 使用加权平均
    volatility_adjustment: true   # 波动率调整
    trend_filter: true           # 趋势过滤

  # 基本面分析配置
  fundamental_analysis:
    enable: false
    news_sources: []
    earnings_dates: []

# 风险管理配置
risk_management:
  # 风险参数
  risk:
    max_drawdown_limit: 0.2     # 最大回撤限制20%
    daily_loss_limit: 0.05      # 单日亏损限制5%
    position_concentration_limit: 0.3  # 单品种持仓集中度限制30%

  # 风险监控
  monitoring:
    check_interval: 60          # 风险检查间隔（秒）
    alert_threshold: 0.8       # 风险预警阈值
    emergency_stop: true        # 紧急止损

  # 压力测试配置
  stress_test:
    enable: true
    scenarios:
      - "market_crash"         # 市场崩盘
      - "liquidity_crisis"     # 流动性危机
      - "volatility_spike"     # 波动率飙升
    historical_data_years: 5   # 历史数据年数

# 通知配置
notifications:
  # 邮件通知
  email:
    enable: false
    smtp_server: ""
    smtp_port: 587
    username: ""
    password: ""
    recipients: []

  # 短信通知
  sms:
    enable: false
    provider: "aliyun"
    access_key: ""
    secret_key: ""
    phone_numbers: []

  # Webhook通知
  webhook:
    enable: false
    url: ""
    headers: {}

# 性能配置
performance:
  # 缓存配置
  cache:
    enable: true
    ttl: 300                 # 缓存生存时间（秒）
    max_size: 1000           # 最大缓存数量
    use_redis: false         # 是否使用 Redis
    redis_host: "localhost"
    redis_port: 6379
    redis_db: 0
    redis_password: ""

  # 异步处理配置
  async:
    max_workers: 5           # 最大工作线程数
    batch_size: 10           # 批次大小
    timeout: 30              # 超时时间（秒）

  # 批量处理配置
  batch:
    min_confidence: 0.5      # 最小置信度
    max_signals_per_batch: 50 # 每批最大信号数
    aggregation_method: "average" # 聚合方法：average, max, min
    max_trades_per_batch: 10 # 每批最大交易数

  # 延迟优化配置
  latency:
    target: 30               # 目标延迟（秒）
    monitoring_interval: 300 # 监控间隔（秒）
    alert_threshold: 1.5     # 超过目标 1.5 倍时告警

  # 成本优化配置
  cost:
    monthly_budget: 100.0    # 月度预算（美元）
    daily_budget: 5.0        # 日预算（美元）
    warning_threshold: 0.8   # 警告阈值（80%）
    enable_cost_monitoring: true # 启用成本监控

  # 数据库配置
  database:
    type: "sqlite"          # sqlite, mysql, postgresql
    path: "data/trading.db"  # 数据库路径
    pool_size: 10           # 连接池大小

  # 监控配置
  monitoring:
    enable_metrics: true    # 启用性能监控
    metrics_interval: 60    # 指标收集间隔（秒）
    log_performance: true    # 记录性能日志
    log_level: "INFO"       # 日志级别

  # 并行处理配置
  parallel:
    max_concurrent: 5        # 最大并发数
    max_per_batch: 10        # 每批最大数

  # 成本优化配置
  cost_optimization:
    enable: true
    save_history: true       # 保存历史成本
    warning_threshold: 0.8   # 警告阈值
    model_costs:             # 模型成本
      gpt-4o:
        input: 0.005
        output: 0.015
      gpt-4o-mini:
        input: 0.00015
        output: 0.0006
      claude-3-opus:
        input: 0.003
        output: 0.015
      claude-3-haiku:
        input: 0.00025
        output: 0.00125